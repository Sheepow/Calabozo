Object subclass: #Game	instanceVariableNames: 'movimientoValido escenario conjuntoDeEscenarios'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Game methodsFor: 'InicializacionesElementosAuxiliares' stamp: 'EduardoValenzuela 10/22/2012 10:13'!inicializaConjuntoDeEscenarios 	"Por ahora el metodo regresara nulo, este metodo estara en funcion de la estructura de Escenario"	^nil! !!Game methodsFor: 'InicializacionesElementosAuxiliares' stamp: 'EduardoValenzuela 10/22/2012 10:12'!inicializaEscenario 	^ Escenario new.! !!Game methodsFor: 'initialize-release' stamp: 'EduardoValenzuela 10/24/2012 08:39'!initialize 	super initialize.	escenario := self inicializaEscenario.	escenario setMotorDeJuego:self.	escenario setDelegadoDeAcciones: self .	escenario asignaDelegados.	conjuntoDeEscenarios := self inicializaConjuntoDeEscenarios.	escenario openInWorld .				! !!Game methodsFor: 'initialize-release' stamp: 'EduardoValenzuela 10/23/2012 01:03'!verificaEntidadesEnPuntox: puntoX yEnY: puntoY	escenario ! !!Game methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 11:52'!laEntidad: unaEntidad haSolapadoA: otraEntidadTranscript show: unaEntidad class superclass  asString , '  : ' , otraEntidad class superclass asString ; cr.( ( (unaEntidad class superclass asString asSymbol)  == #Personaje ) &  ( ( otraEntidad class superclass asString  asSymbol)  == #Objeto ) ) ifTrue:   [	otraEntidad SurtirEfectoa: unaEntidad .  ]! !PasteUpMorph subclass: #Escenario	instanceVariableNames: 'conjuntoDeEntidades marcador nombre motorDeJuego delegadoDeAcciones'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/24/2012 12:51'!asignaDelegados 	conjuntoDeEntidades do: [:each |		(each className asSymbol == #Jugador ) ifTrue: 			[each asignaDelegadoMovimiento: self .			 Transcript show:'Acabo de asignar como delegado movimiento el objeto ', self asString ,' en el objeto de ', each asString ;cr.].		(each className asSymbol == #Enemigo ) ifTrue: 			[each asignaDelegadoMovimiento: self .			 Transcript  show: 'Acabo de asignar como delegado movimiento el objeto ', self asString ,' en el objeto de ', each asString ;cr. ].  		each setDelegadoDeNivel: self].! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/23/2012 08:14'!inicializaEntidades	| unaListaDeEntidadesDiversas|			unaListaDeEntidadesDiversas := OrderedCollection new.	unaListaDeEntidadesDiversas add: Jugador new.	unaListaDeEntidadesDiversas add: Enemigo new.	unaListaDeEntidadesDiversas add: Pocion new.	unaListaDeEntidadesDiversas add: Cofre new.	self setConjuntoDeEntidades: unaListaDeEntidadesDiversas ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/23/2012 01:28'!initialize	super initialize.	self inicializaEntidades .	self disableDragNDrop.	bounds := 100@100 corner: 400@400.	color := Color paleBlue darker.	conjuntoDeEntidades do: [:each | self addMorph: each . Transcript show: 'agregada instancia de ', each asString ; cr. ].	! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/23/2012 01:22'!obtenerConjuntoDeEntidades^conjuntoDeEntidades ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/24/2012 00:59'!obtenerHitbox 	"aqui definimos el valor que toma el hitbox del personaje a partir de su posicion"	^ 15! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/24/2012 12:54'!quitarLaInstancia: unaInstancia	Transcript show: 'quitar la instancia', unaInstancia asString , ' de la lista'; cr.	"TODO: quitar una instancia de lista de instancias"		Transcript show: 'Una instancia eliminada, se supone :), pues la lista ahora es: ', self obtenerConjuntoDeEntidades asString ; cr.! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/22/2012 10:35'!setConjuntoDeEntidades: unaColleccionDeEntidades	conjuntoDeEntidades := unaColleccionDeEntidades ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/24/2012 08:36'!setDelegadoDeAcciones: unDelegadoDeAcciones	delegadoDeAcciones := unDelegadoDeAcciones ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/22/2012 10:36'!setMarcador	marcador := 0 ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/23/2012 01:01'!setMotorDeJuego: unDelegado	motorDeJuego := unDelegado ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/22/2012 10:36'!setNombre: unNombre	nombre := unNombre ! !!Escenario methodsFor: 'initialization' stamp: 'EduardoValenzuela 10/24/2012 08:45'!verificarSolapamiento	| coleccionDeEntidades contador aux|	coleccionDeEntidades  := OrderedCollection  new.	contador :=1.	 (conjuntoDeEntidades reject: [:each | (each className asSymbol) == #Jugador] ) do: [:each | Transcript  show: 'extrayendo punto de ' , each asString ; cr. coleccionDeEntidades  add: each.].	Transcript show: 'El conjunto de puntos de la coleccion es la siguiente: ', coleccionDeEntidades  asString  ;cr.		aux := (conjuntoDeEntidades select: [:each | (each className asSymbol) == #Jugador] )first .	coleccionDeEntidades  do:	[:each |	 Transcript show:' Jugador Pos:  ', aux position asString  , ' morph: ', each asString, 'Pos: ',each position asString ; cr.	(     ((aux posX + (self obtenerHitbox)) > (each posX - (self obtenerHitbox))) &		((aux posX - (self obtenerHitbox )) < (each posX +(self obtenerHitbox))) &		((aux posY + (self obtenerHitbox )) > (each posY - (self obtenerHitbox))) &		((aux posY - (self obtenerHitbox)) < (each posY  + (self obtenerHitbox )))    ) 		ifTrue: 		[ Transcript show: '---------El Jugador a solapado con objeto: ' , each asString , 'punto: ',each position asString ; cr. 		delegadoDeAcciones laEntidad: aux haSolapadoA: each.]	   ]! !Morph subclass: #Entidad	instanceVariableNames: 'delegadoDeNivel'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/2/2012 10:52'!cambiarSprite: unIndice enElConjuntoDeSprites: elConjunto	self ! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:42'!commitSepukku	delegadoDeNivel quitarLaInstancia: self.	self delete .! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:43'!hacerHarakiri 	delegadoDeNivel quitarLaInstancia: self.	self delete .! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 10:11'!initialize 	super initialize .! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 11:31'!obtenersuperclassName	Transcript show: 'Superclass'! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/2/2012 10:41'!posX	^self position x.! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/2/2012 10:42'!posY	^self position y.! !!Entidad methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:50'!setDelegadoDeNivel: unDelegado	delegadoDeNivel := unDelegado ! !Entidad subclass: #Personaje	instanceVariableNames: 'delegadoMovimiento hp maxhp'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:04'!HP	^hp! !!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/23/2012 08:18'!asignaDelegadoMovimiento: unDelegado	delegadoMovimiento := unDelegado ! !!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:21'!aumentarHP: unaCantidadAAumentar	"Aqui es donde nuestro heroe aumenta sus hit points de acuerdo al maximo"	((self HP + unaCantidadAAumentar) > self maxHP) 	ifTrue: [		self sethp: self maxHP	] ifFalse: [		self sethp:  (self HP + unaCantidadAAumentar )	] .	Transcript show: 'HP maximo es: ', self maxHP asString ; cr.	Transcript show: 'La cantidad de HP de', self asString ,' es de', self HP asString,'!!!!'; cr.! !!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:14'!initialize 	super initialize .	self setMaxHP: 12.	self sethp: 5.	! !!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:11'!maxHP	^maxhp! !!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:13'!setMaxHP: cantidadNuevaDeMaximoHP	maxhp := cantidadNuevaDeMaximoHP ! !!Personaje methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:13'!sethp: cantidadNuevaDeHP	hp := cantidadNuevaDeHP ! !Personaje subclass: #Jugador	instanceVariableNames: 'delegadoDeAcciones'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Jugador methodsFor: '*Keymapping-Core-override' stamp: 'EduardoValenzuela 10/23/2012 08:21'!handleKeystroke: anEvent 	| keyValue |	keyValue := anEvent keyValue. 	keyValue = 30 "up arrow" 		ifTrue: [self position: self position - (0 @ 15)]. 	keyValue = 31 "down arrow" 		ifTrue: [self position: self position + (0 @ 15)].	keyValue = 29 "right arrow"		ifTrue: [self position: self position + (15 @ 0)].	keyValue = 28 "left arrow"		ifTrue: [self position: self position - (15 @ 0)].		delegadoMovimiento verificarSolapamiento .! !!Jugador methodsFor: '*Polymorph-Widgets' stamp: 'EduardoValenzuela 9/23/2012 19:02'!handlesMouseOver: anEvent	^true! !!Jugador methodsFor: 'event handling' stamp: 'EduardoValenzuela 9/23/2012 19:03'!mouseLeave: anEvent 	anEvent hand newKeyboardFocus: self! !!Jugador methodsFor: 'initialize' stamp: 'EduardoValenzuela 10/22/2012 10:50'!initialize 	super initialize.	self position: 150@150.	self takeKeyboardFocus.! !!Jugador methodsFor: 'Logica de Jugador' stamp: 'EduardoValenzuela 10/2/2012 10:24'!movimientoALaDerecha	| pos |		pos := self position .	pos x > 350 ifTrue: [^false].	^true.! !!Jugador methodsFor: 'Logica de Jugador' stamp: 'EduardoValenzuela 10/2/2012 10:23'!movimientoALaIzquierda	| pos |		pos := self position.		pos x < 100 ifTrue: [^ false] .	^ true.! !!Jugador methodsFor: 'Logica de Jugador' stamp: 'EduardoValenzuela 10/2/2012 10:25'!movimientoAbajo	| pos |	pos := self position .	pos y > 350 ifTrue: [^false].	^true.! !!Jugador methodsFor: 'Logica de Jugador' stamp: 'EduardoValenzuela 10/2/2012 10:29'!movimientoArriba	| pos |	pos := self position .	pos y < 100 ifTrue: [^false] .	^true .! !!Jugador methodsFor: 'Logica de Jugador' stamp: 'EduardoValenzuela 10/1/2012 08:56'!movimientoValido: unaDireccion	"verifica en el nivel que no esté traspasando un morph"	| pos |		pos := self position.		(pos x > 350 & (unaDireccion value == 4) )"derecha"		ifTrue:  [ ^false ].	(pos y > 350 & (unaDireccion value == 2) )"abajo"		ifTrue: [ ^false ].	(pos x < 115 & (unaDireccion value == 3) ) "izquierda"		ifTrue: [ ^false ].	(pos y < 115 & (unaDireccion value == 1) )"arriba"		ifTrue: [ ^false ].		^true.! !!Jugador methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/23/2012 01:07'!setDelegadoDeAcciones: unDelegado 	delegadoDeAcciones := unDelegado ! !Entidad subclass: #ObjetoDeEscenario	instanceVariableNames: 'sePuedeTraspasar'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!ObjetoDeEscenario methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/21/2012 23:57'!SetSePuedeTraspasar: anStatement	sePuedeTraspasar  = anStatement ! !!ObjetoDeEscenario methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/21/2012 23:58'!esTraspasable	^sePuedeTraspasar ! !Personaje subclass: #Enemigo	instanceVariableNames: 'movimientoValido'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Enemigo methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/22/2012 10:55'!initialize 	super initialize .	self position: 200@250.	self color: Color yellow.! !ObjetoDeEscenario subclass: #Objeto	instanceVariableNames: ''	classVariableNames: 'nombre'	poolDictionaries: ''	category: 'AdventureGame'!!Objeto methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 10:32'!SurtirEfectoa: laEntidad"Este metodo se hizo para hacer override *Guiño Guiño*"	Transcript show: '****Efecto desconocido para ', laEntidad asString .! !!Objeto methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 09:56'!initialize	super initialize .	! !Objeto subclass: #Pocion	instanceVariableNames: 'cantidadACurar tipo'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Pocion methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:55'!SurtirEfectoa: unPersonaje	 unPersonaje aumentarHP: self curar.	 self commitSepukku .! !!Pocion methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:03'!curar ^ cantidadACurar ! !!Pocion methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/24/2012 12:27'!initialize 	super initialize .	cantidadACurar := 5.	tipo:= 'normal'.	self position: 200@300.	self color: Color magenta.! !Objeto subclass: #Cofre	instanceVariableNames: 'cantidad contenido status'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Cofre methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/22/2012 10:52'!initialize 	super initialize .	self position: 200@200.! !ObjetoDeEscenario subclass: #Item	instanceVariableNames: 'nombreElemento'	classVariableNames: ''	poolDictionaries: ''	category: 'AdventureGame'!!Item methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/22/2012 00:02'!SetNombreDeElemento: unNombre	nombreElemento  = unNombre ! !!Item methodsFor: 'as yet unclassified' stamp: 'EduardoValenzuela 10/22/2012 00:02'!nombreDelElemento	^nombreElemento ! !